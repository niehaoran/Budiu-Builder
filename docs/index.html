<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Budiu-Builder 应用构建系统</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header>
    <h1>Budiu-Builder</h1>
    <p>基于GitHub Actions的自动构建系统</p>
  </header>

  <main>
    <div class="card">
      <h2>提交构建</h2>
      <form id="buildForm">
        <!-- 仓库信息 -->
        <div class="form-section">
          <h3>代码仓库信息</h3>
          <div class="form-group">
            <label for="repoUrl">代码仓库 URL: <span class="required">*</span></label>
            <input type="text" id="repoUrl" placeholder="例如: https://github.com/username/repo" required>
            <div class="hint">输入完整仓库URL，如果URL包含分支信息将自动填充分支字段</div>
          </div>

          <div class="form-group">
            <label for="branch">分支:</label>
            <input type="text" id="branch" value="main">
            <div class="hint">系统将尝试自动从URL检测分支，未指定时使用默认分支</div>
          </div>

          <div class="form-group">
            <label for="repoToken">仓库访问令牌: <span class="optional">(私有仓库需要)</span></label>
            <input type="password" id="repoToken" placeholder="私有仓库的个人访问令牌">
            <div class="hint">此令牌用于克隆私有仓库，不会被保存</div>
          </div>
        </div>

        <!-- 镜像信息 -->
        <div class="form-section">
          <h3>镜像信息</h3>
          <div class="form-group">
            <label for="imageName">镜像名称: <span class="required">*</span></label>
            <input type="text" id="imageName" placeholder="例如: myusername/myapp" required>
          </div>

          <div class="form-group">
            <label for="imageTag">镜像标签:</label>
            <input type="text" id="imageTag" value="latest">
          </div>

          <div class="form-group">
            <label for="registry">镜像仓库地址:</label>
            <input type="text" id="registry" value="docker.io">
          </div>
        </div>

        <!-- Docker凭据 -->
        <div class="form-section">
          <h3>Docker凭据</h3>
          <div class="form-group">
            <label for="dockerUsername">Docker用户名: <span class="required">*</span></label>
            <input type="text" id="dockerUsername" placeholder="Docker仓库用户名" required>
          </div>

          <div class="form-group">
            <label for="dockerPassword">Docker密码/令牌: <span class="required">*</span></label>
            <input type="password" id="dockerPassword" placeholder="Docker仓库密码或访问令牌" required>
            <div class="hint">此密码/令牌用于推送镜像，不会被保存</div>
          </div>
        </div>

        <!-- GitHub设置 -->
        <div class="form-section">
          <h3>GitHub设置</h3>
          <div class="form-group">
            <label for="githubToken">GitHub令牌: <span class="required">*</span></label>
            <input type="password" id="githubToken" placeholder="GitHub个人访问令牌" required>
            <div class="hint">用于触发GitHub Actions工作流，不会被保存</div>
          </div>

          <div class="form-group">
            <label for="callbackUrl">回调URL: <span class="optional">(可选)</span></label>
            <input type="text" id="callbackUrl" placeholder="构建完成后通知的URL">
            <div class="hint">构建完成后通知的URL，不填写则不发送通知</div>
          </div>
        </div>

        <!-- 记住选项 -->
        <div class="form-group checkbox-group">
          <input type="checkbox" id="rememberNonSensitive" checked>
          <label for="rememberNonSensitive">记住非敏感信息(仓库URL、镜像名称等)</label>
        </div>

        <button type="submit">提交构建请求</button>
      </form>
    </div>

    <div id="statusCard" class="card hidden">
      <h2>构建状态</h2>
      <div id="statusOutput" class="status"></div>

      <div id="buildDetails" class="hidden">
        <h3>构建详情</h3>
        <table>
          <tr>
            <th>构建 ID</th>
            <td id="buildId"></td>
          </tr>
          <tr>
            <th>状态</th>
            <td id="buildStatus"></td>
          </tr>
          <tr>
            <th>创建时间</th>
            <td id="createdAt"></td>
          </tr>
          <tr>
            <th>更新时间</th>
            <td id="updatedAt"></td>
          </tr>
          <tr id="imageRow" class="hidden">
            <th>镜像</th>
            <td id="imageUrl"></td>
          </tr>
        </table>

        <button id="refreshStatus" style="margin-top: 15px;">刷新状态</button>
      </div>
    </div>
  </main>

  <footer>
    <p>Budiu-Builder &copy; 2023 - <a href="https://github.com/niehaoran/Budiu-Builder" target="_blank">GitHub仓库</a>
    </p>
  </footer>

  <script src="app.js"></script>
</body>

</html>